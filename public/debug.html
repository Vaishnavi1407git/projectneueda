<!DOCTYPE html>
<html>
<head>
    <title>Chart Debug</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .debug-info { background: #f0f0f0; padding: 10px; margin: 10px 0; }
        .chart-container { width: 400px; height: 400px; border: 2px solid #ccc; margin: 20px 0; }
        canvas { border: 1px solid red; }
    </style>
</head>
<body>
    <h1>Chart Debug Page</h1>
    
    <div class="debug-info" id="debugInfo">Loading...</div>
    
    <h2>Test Pie Chart</h2>
    <div class="chart-container">
        <canvas id="testPieChart"></canvas>
    </div>
    
    <h2>Test Bar Chart</h2>
    <div class="chart-container">
        <canvas id="testBarChart"></canvas>
    </div>

    <script>
        const debugInfo = document.getElementById('debugInfo');
        
        function log(message) {
            console.log(message);
            debugInfo.innerHTML += message + '<br>';
        }
        
        // Check Chart.js
        if (typeof Chart === 'undefined') {
            log('❌ Chart.js is NOT loaded');
        } else {
            log('✅ Chart.js loaded, version: ' + Chart.version);
        }
        
        // Test data (same as your portfolio)
        const testData = {
            labels: ['TCS', 'TATA', 'WIPRO'],
            values: [1000, 10000, 500]
        };
        
        log('Test data: ' + JSON.stringify(testData));
        
        // Create test pie chart
        try {
            const pieCtx = document.getElementById('testPieChart').getContext('2d');
            const pieChart = new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: testData.labels,
                    datasets: [{
                        data: testData.values,
                        backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56'],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
            log('✅ Pie chart created successfully');
        } catch (error) {
            log('❌ Pie chart error: ' + error.message);
        }
        
        // Create test bar chart
        try {
            const barCtx = document.getElementById('testBarChart').getContext('2d');
            const barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: testData.labels,
                    datasets: [{
                        label: 'Stock Value',
                        data: testData.values,
                        backgroundColor: 'rgba(75, 192, 192, 0.7)',
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
            log('✅ Bar chart created successfully');
        } catch (error) {
            log('❌ Bar chart error: ' + error.message);
        }
        
        // Test API
        fetch('/api/portfolio')
            .then(response => response.json())
            .then(data => {
                log('✅ API data received: ' + JSON.stringify(data));
            })
            .catch(error => {
                log('❌ API error: ' + error.message);
            });
    </script>
</body>
</html>
